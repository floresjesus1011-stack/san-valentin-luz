<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Para Luz üíñ</title>

  <style>
    :root{
      --pink: #ff4fa3;
      --soft: #ffe3f1;
      --dark: #8a0042;
      --card: rgba(255,255,255,0.93);
    }
    *{ box-sizing: border-box; }

    body{
      margin:0;
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: linear-gradient(135deg, var(--soft), #ffd1e8, #ffc2df);
      overflow:hidden;
      padding: 16px;
    }

    .card{
      width:min(640px, 94vw);
      background: var(--card);
      border: 2px solid rgba(255,79,163,0.22);
      border-radius: 24px;
      padding: 22px 18px 18px;
      text-align:center;
      box-shadow: 0 20px 55px rgba(0,0,0,0.22);
      backdrop-filter: blur(6px);
      position: relative;
    }

    .badge{
      display:inline-block;
      padding: 8px 14px;
      border-radius: 999px;
      background: rgba(255,79,163,0.14);
      border: 1px solid rgba(255,79,163,0.22);
      color: var(--dark);
      font-weight: 900;
      margin-bottom: 10px;
    }

    h1{
      margin: 10px 0 10px;
      color: var(--dark);
      font-size: clamp(24px, 4.2vw, 34px);
      line-height: 1.15;
    }

    .sub{
      margin: 0 0 16px;
      color:#6b1a4a;
      font-weight: 650;
      opacity: 0.95;
    }

    /* √Årea de botones (NO flotante dentro) */
    .buttons{
      position: relative;
      width: min(520px, 92vw);
      margin: 14px auto 12px;
      height: 140px; /* espacio para que NO huya sin tapar */
    }

    button{
      border:0;
      border-radius: 999px;
      padding: 18px 30px;
      font-weight: 950;
      cursor:pointer;
      transition: transform .12s ease, filter .12s ease;
      font-size: 22px;
      min-width: 170px;
      user-select:none;
      touch-action: manipulation;
      position: absolute;
      left: 50%;
      top: 10px;
      transform: translateX(-50%);
    }

    button:hover{ filter: brightness(1.03); }

    .yes{
      background: linear-gradient(135deg, var(--pink), #ff7cc2);
      color:white;
      box-shadow: 0 12px 24px rgba(255,79,163,0.28);
      transform-origin: center;
      z-index: 5; /* siempre arriba visualmente */
    }

    .no{
      background:#b8b8b8;
      color:white;
      z-index: 4;
    }

    /* Imagen debajo y m√°s chica */
    .nayeon-wrap{
      margin: 10px auto 2px;
      width: min(270px, 74vw);
      aspect-ratio: 1 / 1;
      border-radius: 18px;
      overflow:hidden;
      box-shadow: 0 14px 30px rgba(0,0,0,0.18);
      border: 2px solid rgba(255,79,163,0.18);
      background: #fff;
    }
    .nayeon-wrap img{
      width:100%;
      height:100%;
      object-fit: cover;
      display:block;
    }

    .tiny{
      margin-top: 10px;
      font-size: 12px;
      color:#6b1a4a;
      opacity:0.75;
    }

    /* corazones */
    .heart{
      position:absolute;
      bottom:-30px;
      user-select:none;
      pointer-events:none;
      animation: floatUp linear infinite;
      opacity:0.8;
      filter: drop-shadow(0 6px 8px rgba(0,0,0,0.14));
    }
    @keyframes floatUp{
      from{ transform: translateY(0) translateX(0) rotate(0deg); }
      to{ transform: translateY(-115vh) translateX(40px) rotate(18deg); }
    }

    /* Cuando ‚Äúbloqueamos‚Äù el S√≠ para evitar toques accidentales */
    .disabled{
      pointer-events: none;
      filter: grayscale(0.1) brightness(0.98);
    }
  </style>
</head>

<body>
  <!-- M√∫sica local (mant√©n twice-24-7.mp3 en el repo) -->
  <audio id="bgm" src="twice-24-7.mp3" loop preload="auto"></audio>

  <div class="card" id="card">
    <div class="badge">üç≠ TWICE ‚Ä¢ Nayeon vibes ‚Ä¢ Para mi Amor Luz</div>

    <h1 id="question">¬øQuieres ser mi Valent√≠n? üíò</h1>
    <p class="sub" id="sub">Luz, mi Amor‚Ä¶ hice esto solo para ti üê∞üíó</p>

    <div class="buttons" id="btnArea">
      <button class="yes" id="yesBtn">S√ç üíï</button>
      <button class="no" id="noBtn">NO üíî</button>
    </div>

    <div class="nayeon-wrap">
      <img id="nayeonImg" alt="Nayeon" />
    </div>

    <div class="tiny" id="tiny">Siempre estar√© contigo mi vida üòå</div>
  </div>

<script>
  // ‚úÖ 5 URLs de Nayeon (Wikimedia)
  const NAYEON_IMAGES = [
    "https://upload.wikimedia.org/wikipedia/commons/thumb/7/72/Nayeon_251120_1.jpg/640px-Nayeon_251120_1.jpg",
    "https://upload.wikimedia.org/wikipedia/commons/thumb/8/86/Im_Na-yeon_performing_at_SAC_2016_03.jpg/640px-Im_Na-yeon_performing_at_SAC_2016_03.jpg",
    "https://idolkpop.home.blog/wp-content/uploads/2019/09/nayeon-curiosidades.jpg?w=400",
    "https://upload.wikimedia.org/wikipedia/commons/thumb/e/e1/Nayeon_251120_2.jpg/640px-Nayeon_251120_2.jpg",
    "https://upload.wikimedia.org/wikipedia/commons/thumb/6/67/Nayeon_241024_2.jpg/640px-Nayeon_241024_2.jpg"
  ];

  // 4 repreguntas; en la 4ta se borra NO
  let noCount = 0;
  const questions = [
    "¬øSegura, Amor? ü•∫",
    "Luz‚Ä¶ pi√©nsalo otra vez üíï",
    "Vamos, mi Amor‚Ä¶ di que s√≠ üòò",
    "Ok, ya no hay bot√≥n NO üòè‚ù§Ô∏è"
  ];

  // M√∫sica
  function startMusic(){
    const bgm = document.getElementById("bgm");
    bgm.play().catch(()=>{});
  }

  // Corazones
  function hearts(n=12){
    for(let i=0;i<n;i++){
      const h = document.createElement("div");
      h.className = "heart";
      h.textContent = Math.random() > 0.5 ? "üíñ" : "üíó";
      h.style.left = (Math.random()*100) + "vw";
      h.style.animationDuration = (4 + Math.random()*6) + "s";
      h.style.fontSize = (14 + Math.random()*22) + "px";
      h.style.opacity = (0.35 + Math.random()*0.6);
      document.body.appendChild(h);
      setTimeout(()=>h.remove(), 12000);
    }
  }
  hearts(18);
  setInterval(()=>hearts(10), 2600);

  // Rotaci√≥n sin repetir hasta agotar
  let remaining = [...NAYEON_IMAGES];
  function pickNextImage(){
    if (remaining.length === 0) remaining = [...NAYEON_IMAGES];
    const i = Math.floor(Math.random() * remaining.length);
    return remaining.splice(i, 1)[0];
  }
  function setNewNayeon(){
    const img = document.getElementById("nayeonImg");
    img.src = pickNextImage() + "?r=" + Date.now();
  }
  setNewNayeon();

  const noBtn = document.getElementById("noBtn");
  const yesBtn = document.getElementById("yesBtn");
  const btnArea = document.getElementById("btnArea");

  // Posicionamiento inicial: separar S√ç y NO para evitar toques accidentales
  function placeInitialButtons(){
    // S√ç arriba centrado
    yesBtn.style.top = "8px";
    yesBtn.style.left = "50%";
    yesBtn.style.transform = "translateX(-50%)";

    // NO abajo centrado (bien separado)
    noBtn.style.top = "78px";
    noBtn.style.left = "50%";
    noBtn.style.transform = "translateX(-50%)";
  }
  placeInitialButtons();

  // ‚ÄúS√ç crece‚Äù
  let yesScale = 1;
  function growYes(){
    yesScale = Math.min(1.65, yesScale + 0.12);
    yesBtn.style.transform = `translateX(-50%) scale(${yesScale})`;
  }

  // Intersecci√≥n de rects (en coords relativas al √°rea)
  function intersects(a, b){
    return !(a.right < b.left || a.left > b.right || a.bottom < b.top || a.top > b.bottom);
  }

  // Evita que NO se ponga encima de S√ç (y adem√°s lo alejamos bastante)
  function moveNoButtonAvoidYes(){
    const areaRect = btnArea.getBoundingClientRect();
    const yesRect  = yesBtn.getBoundingClientRect();

    const noW = noBtn.offsetWidth;
    const noH = noBtn.offsetHeight;

    const maxX = Math.max(0, areaRect.width - noW);
    const maxY = Math.max(0, areaRect.height - noH);

    // zona prohibida alrededor del S√ç (margen GRANDE para m√≥vil)
    const pad = 32;

    const forbidden = {
      left:   (yesRect.left - areaRect.left) - pad,
      right:  (yesRect.right - areaRect.left) + pad,
      top:    (yesRect.top - areaRect.top) - pad,
      bottom: (yesRect.bottom - areaRect.top) + pad
    };

    // Intentos para encontrar punto seguro
    for (let tries = 0; tries < 60; tries++){
      const x = Math.random() * maxX;
      const y = Math.random() * maxY;

      const candidate = { left:x, top:y, right:x+noW, bottom:y+noH };

      // Condici√≥n extra: que NO quede ‚Äúmuy arriba‚Äù cerca del S√ç (evita coincidencias)
      const farEnough = y > (forbidden.bottom + 6) || y + noH < (forbidden.top - 6);

      if (!intersects(candidate, forbidden) && farEnough) {
        noBtn.style.left = (x + noW/2) + "px";
        noBtn.style.top  = y + "px";
        noBtn.style.transform = "translateX(-50%)";
        return;
      }
    }

    // Fallback: abajo al centro
    noBtn.style.left = "50%";
    noBtn.style.top  = (maxY) + "px";
    noBtn.style.transform = "translateX(-50%)";
  }

  // Evitar que S√ç se presione por accidente cuando la intenci√≥n es NO:
  // bloqueamos S√ç por un instante tras interacci√≥n con NO
  function lockYesBriefly(){
    yesBtn.classList.add("disabled");
    setTimeout(() => yesBtn.classList.remove("disabled"), 450);
  }

  function reject(){
    startMusic();
    lockYesBriefly();
    setNewNayeon();   // ‚úÖ cambia imagen SIEMPRE
    growYes();

    document.getElementById("question").textContent =
      questions[Math.min(noCount, questions.length - 1)];
    document.getElementById("sub").textContent =
      "Cada NO me hace insistir m√°s‚Ä¶ y sacar otra foto de Nayeon üê∞üíó";

    noCount++;

    if (noCount >= 4){
      noBtn.style.display = "none";
      document.getElementById("tiny").textContent = "Ya fue‚Ä¶ el destino dice que es S√ç üòåüíò";
    } else {
      // luego huye lejos del S√ç
      setTimeout(moveNoButtonAvoidYes, 20);
    }
  }

  function accept(){
    startMusic();
    const card = document.getElementById("card");
    card.innerHTML = `
      <div class="badge">üíó TWICE approved ‚Ä¢ ONCE forever</div>
      <h1>üíñüíñüíñ</h1>
      <h1>Sab√≠a que aceptar√≠as, eres el amor de mi vida.</h1>
      <h1>Poto amorcito üíï</h1>
      <div class="tiny" style="margin-top:10px;">Luz, mi Amor‚Ä¶ feliz San Valent√≠n üê∞</div>
    `;
    hearts(26);
  }

  // Eventos
  yesBtn.addEventListener("click", accept);

  // En desktop: al acercarse, huye
  noBtn.addEventListener("mouseenter", () => {
    if (noCount < 4) moveNoButtonAvoidYes();
  });

  // En m√≥vil/desktop: pointerdown ejecuta NO inmediatamente y luego huye
  noBtn.addEventListener("pointerdown", (e) => {
    if (noCount >= 4) return;
    e.preventDefault();          // evita clicks fantasmas
    reject();
  }, { passive: false });
</script>
</body>
</html>
