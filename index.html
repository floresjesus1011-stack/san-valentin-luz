<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Para Luz üíñ</title>

  <style>
    :root{
      --pink: #ff4fa3;
      --soft: #ffe3f1;
      --dark: #8a0042;
      --card: rgba(255,255,255,0.93);
    }
    *{ box-sizing: border-box; }

    body{
      margin:0;
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: linear-gradient(135deg, var(--soft), #ffd1e8, #ffc2df);
      overflow:hidden;
      padding: 16px;
    }

    .card{
      width:min(620px, 94vw);
      background: var(--card);
      border: 2px solid rgba(255,79,163,0.22);
      border-radius: 24px;
      padding: 22px 18px 18px;
      text-align:center;
      box-shadow: 0 20px 55px rgba(0,0,0,0.22);
      backdrop-filter: blur(6px);
      position: relative;
    }

    .badge{
      display:inline-block;
      padding: 8px 14px;
      border-radius: 999px;
      background: rgba(255,79,163,0.14);
      border: 1px solid rgba(255,79,163,0.22);
      color: var(--dark);
      font-weight: 900;
      margin-bottom: 10px;
    }

    h1{
      margin: 10px 0 10px;
      color: var(--dark);
      font-size: clamp(24px, 4.2vw, 34px);
      line-height: 1.15;
    }

    .sub{
      margin: 0 0 16px;
      color:#6b1a4a;
      font-weight: 650;
      opacity: 0.95;
    }

    .buttons{
      display:flex;
      gap: 14px;
      justify-content:center;
      flex-wrap: wrap;
      margin-top: 12px;
      margin-bottom: 14px;
      position: relative;
      min-height: 110px; /* un poco m√°s para que NO tenga espacio sin tapar S√ç */
    }

    button{
      border:0;
      border-radius: 999px;
      padding: 18px 30px;
      font-weight: 950;
      cursor:pointer;
      transition: transform .12s ease, filter .12s ease;
      font-size: 22px;
      min-width: 160px;
      user-select:none;
      touch-action: manipulation;
      position: relative;
    }

    .yes{
      background: linear-gradient(135deg, var(--pink), #ff7cc2);
      color:white;
      box-shadow: 0 12px 24px rgba(255,79,163,0.28);
      transform-origin: center;
      z-index: 3;           /* SI encima */
    }
    .no{
      background:#b8b8b8;
      color:white;
      z-index: 2;
    }

    .nayeon-wrap{
      margin: 10px auto 2px;
      width: min(270px, 74vw);
      aspect-ratio: 1 / 1;
      border-radius: 18px;
      overflow:hidden;
      box-shadow: 0 14px 30px rgba(0,0,0,0.18);
      border: 2px solid rgba(255,79,163,0.18);
      background: #fff;
    }
    .nayeon-wrap img{
      width:100%;
      height:100%;
      object-fit: cover;
      display:block;
    }

    .tiny{
      margin-top: 10px;
      font-size: 12px;
      color:#6b1a4a;
      opacity:0.75;
    }

    .heart{
      position:absolute;
      bottom:-30px;
      user-select:none;
      pointer-events:none;
      animation: floatUp linear infinite;
      opacity:0.8;
      filter: drop-shadow(0 6px 8px rgba(0,0,0,0.14));
    }
    @keyframes floatUp{
      from{ transform: translateY(0) translateX(0) rotate(0deg); }
      to{ transform: translateY(-115vh) translateX(40px) rotate(18deg); }
    }

    .no-floating{
      position: absolute !important;
      z-index: 2;          /* SI sigue encima por z-index 3 */
      transform: translate(0,0) !important;
    }
  </style>
</head>

<body>
  <audio id="bgm" src="twice-24-7.mp3" loop preload="auto"></audio>

  <div class="card" id="card">
    <div class="badge">üç≠ TWICE ‚Ä¢ Nayeon vibes ‚Ä¢ Para mi Amor Luz</div>

    <h1 id="question">¬øQuieres ser mi Valent√≠n? üíò</h1>
    <p class="sub" id="sub">Luz, mi Amor‚Ä¶ hice esto solo para ti üê∞üíó</p>

    <div class="buttons" id="btnArea">
      <button class="yes" id="yesBtn">S√ç üíï</button>
      <button class="no" id="noBtn">NO üíî</button>
    </div>

    <div class="nayeon-wrap">
      <img id="nayeonImg" alt="Nayeon" />
    </div>

    <div class="tiny" id="tiny">Siempre estar√© contigo mi vida üòå</div>
  </div>

<script>
  // Im√°genes (puedes agregar m√°s URLs)
  const NAYEON_IMAGES = [
  "https://upload.wikimedia.org/wikipedia/commons/thumb/7/72/Nayeon_251120_1.jpg/640px-Nayeon_251120_1.jpg",
  "https://upload.wikimedia.org/wikipedia/commons/thumb/8/86/Im_Na-yeon_performing_at_SAC_2016_03.jpg/640px-Im_Na-yeon_performing_at_SAC_2016_03.jpg",
  "https://idolkpop.home.blog/wp-content/uploads/2019/09/nayeon-curiosidades.jpg?w=400",
  "https://i.pinimg.com/736x/1f/2c/f2/1f2cf28d2d692ee80b4f75b931cbcd39.jpg",
];
  // 4 repreguntas; en la 4ta se borra NO
  let noCount = 0;
  const questions = [
    "¬øSegura, Amor? ü•∫",
    "Luz‚Ä¶ pi√©nsalo otra vez üíï",
    "Vamos, mi Amor‚Ä¶ di que s√≠ üòò",
    "Ok, ya no hay bot√≥n NO üòè‚ù§Ô∏è"
  ];

  // M√∫sica
  function startMusic(){
    const bgm = document.getElementById("bgm");
    bgm.play().catch(()=>{});
  }

  // Corazones
  function hearts(n=12){
    for(let i=0;i<n;i++){
      const h = document.createElement("div");
      h.className = "heart";
      h.textContent = Math.random() > 0.5 ? "üíñ" : "üíó";
      h.style.left = (Math.random()*100) + "vw";
      h.style.animationDuration = (4 + Math.random()*6) + "s";
      h.style.fontSize = (14 + Math.random()*22) + "px";
      h.style.opacity = (0.35 + Math.random()*0.6);
      document.body.appendChild(h);
      setTimeout(()=>h.remove(), 12000);
    }
  }
  hearts(18);
  setInterval(()=>hearts(10), 2600);

  // Rotaci√≥n sin repetir hasta agotar
  let remaining = [...NAYEON_IMAGES];
  function pickNextImage(){
    if (remaining.length === 0) remaining = [...NAYEON_IMAGES];
    const i = Math.floor(Math.random() * remaining.length);
    return remaining.splice(i, 1)[0];
  }
  function setNewNayeon(){
    const img = document.getElementById("nayeonImg");
    img.src = pickNextImage() + "?r=" + Date.now();
  }
  setNewNayeon();

  // Botones y √°rea
  const noBtn = document.getElementById("noBtn");
  const yesBtn = document.getElementById("yesBtn");
  const btnArea = document.getElementById("btnArea");

  // ‚ÄúS√ç crece‚Äù
  let yesScale = 1;
  function growYes(){
    yesScale = Math.min(1.65, yesScale + 0.12);
    yesBtn.style.transform = `scale(${yesScale})`;
  }

  // Convierte NO a flotante
  function ensureNoFloating(){
    if (!noBtn.classList.contains("no-floating")) {
      noBtn.classList.add("no-floating");
      // fijar posici√≥n inicial (para que left/top funcionen)
      noBtn.style.left = "0px";
      noBtn.style.top  = "0px";
    }
  }

  // Chequeo de intersecci√≥n entre rects
  function intersects(a, b){
    return !(a.right < b.left || a.left > b.right || a.bottom < b.top || a.top > b.bottom);
  }

  // Mueve NO a una posici√≥n que NO tape el SI
  function moveNoButtonAvoidYes(){
    ensureNoFloating();

    const areaRect = btnArea.getBoundingClientRect();
    const yesRect  = yesBtn.getBoundingClientRect();

    // Medidas del NO (usar offsetWidth/Height es estable)
    const noW = noBtn.offsetWidth;
    const noH = noBtn.offsetHeight;

    const maxX = Math.max(0, areaRect.width - noW);
    const maxY = Math.max(0, areaRect.height - noH);

    // ‚Äúzona prohibida‚Äù alrededor del SI (margen extra)
    const pad = 18;

    // Convertir yesRect a coords relativas al √°rea
    const forbidden = {
      left:   (yesRect.left - areaRect.left) - pad,
      right:  (yesRect.right - areaRect.left) + pad,
      top:    (yesRect.top - areaRect.top) - pad,
      bottom: (yesRect.bottom - areaRect.top) + pad
    };

    // Intentar varias veces encontrar un lugar seguro
    for (let tries = 0; tries < 40; tries++){
      const x = Math.random() * maxX;
      const y = Math.random() * maxY;

      const candidate = {
        left: x,
        top: y,
        right: x + noW,
        bottom: y + noH
      };

      if (!intersects(candidate, forbidden)) {
        noBtn.style.left = x + "px";
        noBtn.style.top  = y + "px";
        return;
      }
    }

    // Si no encuentra (muy raro), lo manda a un lugar ‚Äúseguro‚Äù por defecto
    noBtn.style.left = "0px";
    noBtn.style.top  = (maxY) + "px";
  }

  // L√≥gica de NO (cambia imagen SIEMPRE)
  function reject(){
    startMusic();
    setNewNayeon();   // ‚úÖ ahora siempre cambia
    growYes();

    const question = document.getElementById("question");
    const sub = document.getElementById("sub");
    const tiny = document.getElementById("tiny");

    question.textContent = questions[Math.min(noCount, questions.length - 1)];
    sub.textContent = "Cada NO me hace insistir m√°s‚Ä¶ y sacar otra foto de Nayeon üê∞üíó";

    noCount++;

    if (noCount >= 4){
      noBtn.style.display = "none";
      tiny.textContent = "Ya fue‚Ä¶ el destino dice que es S√ç üòåüíò";
    } else {
      // despu√©s de ‚ÄúNO‚Äù, que huya SIN tapar el SI
      // peque√±o delay para que calcule bien tama√±os en m√≥vil
      setTimeout(moveNoButtonAvoidYes, 30);
    }
  }

  function accept(){
    startMusic();
    const card = document.getElementById("card");
    card.innerHTML = `
      <div class="badge">üíó TWICE approved ‚Ä¢ ONCE forever</div>
      <h1>üíñüíñüíñ</h1>
      <h1>Sab√≠a que aceptar√≠as, eres el amor de mi vida.</h1>
      <h1>Poto amorcito üíï</h1>
      <div class="tiny" style="margin-top:10px;">Luz, mi Amor‚Ä¶ feliz San Valent√≠n üê∞</div>
    `;
    hearts(26);
  }

  // Eventos:
  // - En desktop: al pasar el mouse, NO huye evitando el SI
  // - En m√≥vil: al tocar NO, primero cuenta como NO (reject) y luego huye
  yesBtn.addEventListener("click", accept);

  noBtn.addEventListener("mouseenter", () => {
    if (noCount < 4) moveNoButtonAvoidYes();
  });

  noBtn.addEventListener("click", () => {
    // ‚úÖ click real garantiza cambio de imagen/pregunta
    if (noCount < 4) reject();
  });

  // En m√≥vil, muchos toques no disparan hover; hacemos ‚Äúpointerdown‚Äù para que se sienta que huye,
  // pero SIN bloquear el click: solo lo movemos un poquito despu√©s.
  noBtn.addEventListener("pointerdown", () => {
    if (noCount < 4) {
      // deja que el click ocurra y luego mueve
      setTimeout(moveNoButtonAvoidYes, 10);
    }
  });
</script>
</body>
</html>

